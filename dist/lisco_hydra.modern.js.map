{"version":3,"file":"lisco_hydra.modern.js","sources":["../src/HydraServer.mjs","../src/HydraClusterServer.mjs"],"sourcesContent":["import { Server } from \"@landra_sistemas/lisco\";\r\nimport { HydraIntegrationPlugin } from \"hydra-integration\";\r\nimport hydra from \"hydra\";\r\n\r\nexport default class HydraServer extends Server {\r\n    async initialize() {\r\n        if (!this.express_config?.hydra) {\r\n            throw new Error(\"HydraServer: config.hydra is required\");\r\n        }\r\n        //Iniciar hydra en modo plugin\r\n        hydra.use(new HydraIntegrationPlugin());\r\n        await hydra.init({\r\n            hydra: this.express_config?.hydra,\r\n        });\r\n        console.log(\"configured hydra\");\r\n        await hydra.registerService();\r\n\r\n        //Sobreescribir la app para que la configuracion del server se realice normalmente.\r\n        this.app = await hydra.integration.getService();\r\n\r\n        //Save for later use\r\n        this.hydra = hydra;\r\n\r\n        //Continuar con la inicializacion normalmente\r\n        await super.initialize();\r\n    }\r\n}\r\n","import { ClusterServer } from \"@landra_sistemas/lisco\";\r\n\r\nexport default class HydraClusterServer extends ClusterServer {\r\n    constructor(app) {\r\n        super(app);\r\n    }\r\n\r\n    async initUnclustered() {\r\n        await this.server.initialize();\r\n        //Ignorar el arranque del server y realizar solo la config. Se hace autom√°ticamente en hydra.\r\n\r\n        //Save for later use as App.hydra\r\n        this.app.hydra = this.server.hydra;\r\n    }\r\n}\r\n"],"names":["HydraServer","Server","initialize","_this$express_config","_this$express_config2","express_config","hydra","Error","use","HydraIntegrationPlugin","init","console","log","registerService","app","integration","getService","HydraClusterServer","ClusterServer","constructor","initUnclustered","server"],"mappings":";;;;AAIe,MAAMA,WAAW,SAASC,MAAM,CAAC;EAC5C,MAAMC,UAAUA,GAAG;IAAA,IAAAC,oBAAA,EAAAC,qBAAA,CAAA;IACf,IAAI,EAAA,CAAAD,oBAAA,GAAC,IAAI,CAACE,cAAc,KAAnBF,IAAAA,IAAAA,oBAAA,CAAqBG,KAAK,CAAE,EAAA;AAC7B,MAAA,MAAM,IAAIC,KAAK,CAAC,uCAAuC,CAAC,CAAA;AAC5D,KAAA;AACA;AACAD,IAAAA,KAAK,CAACE,GAAG,CAAC,IAAIC,sBAAsB,EAAE,CAAC,CAAA;IACvC,MAAMH,KAAK,CAACI,IAAI,CAAC;MACbJ,KAAK,EAAA,CAAAF,qBAAA,GAAE,IAAI,CAACC,cAAc,KAAA,IAAA,GAAA,KAAA,CAAA,GAAnBD,qBAAA,CAAqBE,KAAAA;AAChC,KAAC,CAAC,CAAA;AACFK,IAAAA,OAAO,CAACC,GAAG,CAAC,kBAAkB,CAAC,CAAA;AAC/B,IAAA,MAAMN,KAAK,CAACO,eAAe,EAAE,CAAA;;AAE7B;IACA,IAAI,CAACC,GAAG,GAAG,MAAMR,KAAK,CAACS,WAAW,CAACC,UAAU,EAAE,CAAA;;AAE/C;IACA,IAAI,CAACV,KAAK,GAAGA,KAAK,CAAA;;AAElB;AACA,IAAA,MAAM,KAAK,CAACJ,UAAU,EAAE,CAAA;AAC5B,GAAA;AACJ;;ACxBe,MAAMe,kBAAkB,SAASC,aAAa,CAAC;EAC1DC,WAAWA,CAACL,GAAG,EAAE;IACb,KAAK,CAACA,GAAG,CAAC,CAAA;AACd,GAAA;EAEA,MAAMM,eAAeA,GAAG;AACpB,IAAA,MAAM,IAAI,CAACC,MAAM,CAACnB,UAAU,EAAE,CAAA;AAC9B;;AAEA;IACA,IAAI,CAACY,GAAG,CAACR,KAAK,GAAG,IAAI,CAACe,MAAM,CAACf,KAAK,CAAA;AACtC,GAAA;AACJ;;;;"}