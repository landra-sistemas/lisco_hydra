{"version":3,"file":"lisco_hydra.modern.js","sources":["../src/HydraServer.mjs","../src/HydraClusterServer.mjs"],"sourcesContent":["import { Server } from \"@landra_sistemas/lisco\";\r\nimport { HydraIntegrationPlugin } from \"hydra-integration\";\r\nimport hydra from \"hydra\";\r\n\r\nexport default class HydraServer extends Server {\r\n    async initialize() {\r\n        if (!this.express_config?.hydra) {\r\n            throw new Error(\"HydraServer: config.hydra is required\");\r\n        }\r\n        //Iniciar hydra en modo plugin\r\n        hydra.use(new HydraIntegrationPlugin());\r\n        await hydra.init({\r\n            hydra: this.express_config?.hydra,\r\n        });\r\n        console.log(\"configured hydra\");\r\n        await hydra.registerService();\r\n\r\n        //Sobreescribir la app para que la configuracion del server se realice normalmente.\r\n        this.app = await hydra.integration.getService();\r\n\r\n        //Save for later use\r\n        this.hydra = hydra;\r\n\r\n        //Continuar con la inicializacion normalmente\r\n        await super.initialize();\r\n    }\r\n}\r\n","import { ClusterServer } from \"@landra_sistemas/lisco\";\r\n\r\nexport default class HydraClusterServer extends ClusterServer {\r\n    constructor(app) {\r\n        super(app);\r\n    }\r\n\r\n    async initUnclustered() {\r\n        await this.server.initialize();\r\n        //Ignorar el arranque del server y realizar solo la config. Se hace autom√°ticamente en hydra.\r\n\r\n        //Save for later use as App.hydra\r\n        this.app.hydra = this.server.hydra;\r\n    }\r\n}\r\n"],"names":["HydraServer","Server","initialize","express_config","hydra","Error","use","HydraIntegrationPlugin","init","console","log","registerService","app","integration","getService","HydraClusterServer","ClusterServer","constructor","initUnclustered","server"],"mappings":";;;;AAIe,MAAMA,WAAN,SAA0BC,MAA1B,CAAiC;AAC5B,EAAA,MAAVC,UAAU,GAAG;AAAA,IAAA,IAAA,oBAAA,EAAA,qBAAA,CAAA;;AACf,IAAA,IAAI,0BAAC,IAAKC,CAAAA,cAAN,aAAC,oBAAqBC,CAAAA,KAAtB,CAAJ,EAAiC;AAC7B,MAAA,MAAM,IAAIC,KAAJ,CAAU,uCAAV,CAAN,CAAA;AACH,KAHc;;;AAKfD,IAAAA,KAAK,CAACE,GAAN,CAAU,IAAIC,sBAAJ,EAAV,CAAA,CAAA;IACA,MAAMH,KAAK,CAACI,IAAN,CAAW;AACbJ,MAAAA,KAAK,EAAE,CAAA,qBAAA,GAAA,IAAA,CAAKD,cAAP,KAAA,IAAA,GAAA,KAAA,CAAA,GAAE,qBAAqBC,CAAAA,KAAAA;AADf,KAAX,CAAN,CAAA;IAGAK,OAAO,CAACC,GAAR,CAAY,kBAAZ,CAAA,CAAA;AACA,IAAA,MAAMN,KAAK,CAACO,eAAN,EAAN,CAVe;;IAaf,IAAKC,CAAAA,GAAL,GAAW,MAAMR,KAAK,CAACS,WAAN,CAAkBC,UAAlB,EAAjB,CAbe;;AAgBf,IAAA,IAAA,CAAKV,KAAL,GAAaA,KAAb,CAhBe;;IAmBf,MAAM,KAAA,CAAMF,UAAN,EAAN,CAAA;AACH,GAAA;;AArB2C;;ACFjC,MAAMa,kBAAN,SAAiCC,aAAjC,CAA+C;EAC1DC,WAAW,CAACL,GAAD,EAAM;AACb,IAAA,KAAA,CAAMA,GAAN,CAAA,CAAA;AACH,GAAA;;AAEoB,EAAA,MAAfM,eAAe,GAAG;AACpB,IAAA,MAAM,KAAKC,MAAL,CAAYjB,UAAZ,EAAN,CADoB;AAIpB;;AACA,IAAA,IAAA,CAAKU,GAAL,CAASR,KAAT,GAAiB,IAAKe,CAAAA,MAAL,CAAYf,KAA7B,CAAA;AACH,GAAA;;AAXyD;;;;"}