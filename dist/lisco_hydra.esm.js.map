{"version":3,"file":"lisco_hydra.esm.js","sources":["../src/HydraServer.mjs","../src/HydraClusterServer.mjs"],"sourcesContent":["import { Server } from \"@landra_sistemas/lisco\";\r\nimport { HydraIntegrationPlugin } from \"hydra-integration\";\r\nimport hydra from \"hydra\";\r\n\r\nexport default class HydraServer extends Server {\r\n    async initialize() {\r\n        if (!this.express_config?.hydra) {\r\n            throw new Error(\"HydraServer: config.hydra is required\");\r\n        }\r\n        //Iniciar hydra en modo plugin\r\n        hydra.use(new HydraIntegrationPlugin());\r\n        await hydra.init({\r\n            hydra: this.express_config?.hydra,\r\n        });\r\n        console.log(\"configured hydra\");\r\n        await hydra.registerService();\r\n\r\n        //Sobreescribir la app para que la configuracion del server se realice normalmente.\r\n        this.app = await hydra.integration.getService();\r\n\r\n        //Save for later use\r\n        this.hydra = hydra;\r\n\r\n        //Continuar con la inicializacion normalmente\r\n        await super.initialize();\r\n    }\r\n}\r\n","import { ClusterServer } from \"@landra_sistemas/lisco\";\r\n\r\nexport default class HydraClusterServer extends ClusterServer {\r\n    constructor(app) {\r\n        super(app);\r\n    }\r\n\r\n    async initUnclustered() {\r\n        await this.server.initialize();\r\n        //Ignorar el arranque del server y realizar solo la config. Se hace autom√°ticamente en hydra.\r\n\r\n        //Save for later use as App.hydra\r\n        this.app.hydra = this.server.hydra;\r\n    }\r\n}\r\n"],"names":["HydraServer","_Server","_inheritsLoose","apply","arguments","_proto","prototype","initialize","_this2$express_config","_this2$express_config2","_this2","express_config","hydra","Error","use","HydraIntegrationPlugin","Promise","resolve","init","then","console","log","registerService","integration","getService","_hydra$integration$ge","app","call","e","reject","Server","HydraClusterServer","_ClusterServer","initUnclustered","server","ClusterServer"],"mappings":"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"}