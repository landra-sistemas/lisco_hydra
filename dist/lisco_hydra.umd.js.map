{"version":3,"file":"lisco_hydra.umd.js","sources":["../src/HydraServer.mjs","../src/HydraClusterServer.mjs"],"sourcesContent":["import { Server } from \"@landra_sistemas/lisco\";\r\nimport { HydraIntegrationPlugin } from \"hydra-integration\";\r\nimport hydra from \"hydra\";\r\n\r\nexport default class HydraServer extends Server {\r\n    async initialize() {\r\n        if (!this.express_config?.hydra) {\r\n            throw new Error(\"HydraServer: config.hydra is required\");\r\n        }\r\n        //Iniciar hydra en modo plugin\r\n        hydra.use(new HydraIntegrationPlugin());\r\n        await hydra.init({\r\n            hydra: this.express_config?.hydra,\r\n        });\r\n        console.log(\"configured hydra\");\r\n        await hydra.registerService();\r\n\r\n        //Sobreescribir la app para que la configuracion del server se realice normalmente.\r\n        this.app = await hydra.integration.getService();\r\n\r\n        //Save for later use\r\n        this.hydra = hydra;\r\n\r\n        //Continuar con la inicializacion normalmente\r\n        await super.initialize();\r\n    }\r\n}\r\n","import { ClusterServer } from \"@landra_sistemas/lisco\";\r\n\r\nexport default class HydraClusterServer extends ClusterServer {\r\n    constructor(app) {\r\n        super(app);\r\n    }\r\n\r\n    async initUnclustered() {\r\n        await this.server.initialize();\r\n        //Ignorar el arranque del server y realizar solo la config. Se hace autom√°ticamente en hydra.\r\n\r\n        //Save for later use as App.hydra\r\n        this.app.hydra = this.server.hydra;\r\n    }\r\n}\r\n"],"names":["HydraServer","_Server","_inheritsLoose","apply","arguments","_proto","prototype","initialize","_this2$express_config","_this2$express_config2","_this2","express_config","hydra","Error","use","HydraIntegrationPlugin","Promise","resolve","init","then","console","log","registerService","integration","getService","_hydra$integration$ge","app","call","e","reject","Server","HydraClusterServer","_ClusterServer","initUnclustered","server","ClusterServer"],"mappings":";;;;;;;;;;;;;;;;;;;;;;AAIqBA,MAAAA,WAAW,0BAAAC,OAAA,EAAA;IAAAC,cAAA,CAAAF,WAAA,EAAAC,OAAA,CAAA,CAAA;EAAA,EAAA,SAAAD,WAAA,GAAA;EAAA,IAAA,OAAAC,OAAA,CAAAE,KAAA,CAAA,IAAA,EAAAC,SAAA,CAAA,IAAA,IAAA,CAAA;EAAA,GAAA;EAAA,EAAA,IAAAC,MAAA,GAAAL,WAAA,CAAAM,SAAA,CAAA;IAAAD,MAAA,CACtBE,UAAU,GAAA,SAAAA,UAAA,GAAA;MAAA,IAAG;QAAA,IAAAC,qBAAA,EAAAC,sBAAA,CAAA;QAAA,IAAAC,MAAA,GACV,IAAI,CAAA;QAAT,IAAI,EAAA,CAAAF,qBAAA,GAACE,MAAA,CAAKC,cAAc,KAAnBH,IAAAA,IAAAA,qBAAA,CAAqBI,KAAK,CAAE,EAAA;EAC7B,QAAA,MAAM,IAAIC,KAAK,CAAC,uCAAuC,CAAC,CAAA;EAC5D,OAAA;EACA;EACAD,MAAAA,yBAAK,CAACE,GAAG,CAAC,IAAIC,uCAAsB,EAAE,CAAC,CAAA;EAAC,MAAA,OAAAC,OAAA,CAAAC,OAAA,CAClCL,yBAAK,CAACM,IAAI,CAAC;UACbN,KAAK,EAAA,CAAAH,sBAAA,GAAEC,MAAA,CAAKC,cAAc,KAAA,IAAA,GAAA,KAAA,CAAA,GAAnBF,sBAAA,CAAqBG,KAAAA;SAC/B,CAAC,EAAAO,IAAA,CAAA,YAAA;EACFC,QAAAA,OAAO,CAACC,GAAG,CAAC,kBAAkB,CAAC,CAAA;UAAC,OAAAL,OAAA,CAAAC,OAAA,CAC1BL,yBAAK,CAACU,eAAe,EAAE,CAAA,CAAAH,IAAA,CAAA,YAAA;EAE7B;EAGA;EAGA;EAAA,UAAA,OAAAH,OAAA,CAAAC,OAAA,CALiBL,yBAAK,CAACW,WAAW,CAACC,UAAU,EAAE,CAAAL,CAAAA,IAAA,WAAAM,qBAAA,EAAA;cAA/Cf,MAAA,CAAKgB,GAAG,GAAAD,qBAAuC,CAAA;cAG/Cf,MAAA,CAAKE,KAAK,GAAGA,yBAAK,CAAA;EAAC,YAAA,OAAAI,OAAA,CAAAC,OAAA,CAAAhB,OAAA,CAAAK,SAAA,CAGPC,UAAU,CAAAoB,IAAA,CAAAjB,MAAA,GAAAS,IAAA,CAAA,YAAA,EAAA,CAAA,CAAA;EAAA,WAAA,CAAA,CAAA;EAAA,SAAA,CAAA,CAAA;EAAA,OAAA,CAAA,CAAA;EAC1B,KAAC,QAAAS,CAAA,EAAA;EAAA,MAAA,OAAAZ,OAAA,CAAAa,MAAA,CAAAD,CAAA,CAAA,CAAA;EAAA,KAAA;EAAA,GAAA,CAAA;EAAA,EAAA,OAAA5B,WAAA,CAAA;EAAA,CAAA,CArBoC8B,YAAM;;ACF1BC,MAAAA,kBAAkB,0BAAAC,cAAA,EAAA;IAAA9B,cAAA,CAAA6B,kBAAA,EAAAC,cAAA,CAAA,CAAA;IACnC,SAAAD,kBAAAA,CAAYL,GAAG,EAAE;EAAA,IAAA,OACbM,cAAA,CAAAL,IAAA,CAAA,IAAA,EAAMD,GAAG,CAAC,IAAA,IAAA,CAAA;EACd,GAAA;EAAC,EAAA,IAAArB,MAAA,GAAA0B,kBAAA,CAAAzB,SAAA,CAAA;IAAAD,MAAA,CAEK4B,eAAe,GAAA,SAAAA,eAAA,GAAA;MAAA,IAAG;QAAA,IAAAvB,MAAA,GACd,IAAI,CAAA;EAAA,MAAA,OAAAM,OAAA,CAAAC,OAAA,CAAJP,MAAA,CAAKwB,MAAM,CAAC3B,UAAU,EAAE,CAAA,CAAAY,IAAA,CAAA,YAAA;EAC9B;;EAEA;UACAT,MAAA,CAAKgB,GAAG,CAACd,KAAK,GAAGF,MAAA,CAAKwB,MAAM,CAACtB,KAAK,CAAA;EAAC,OAAA,CAAA,CAAA;EACvC,KAAC,QAAAgB,CAAA,EAAA;EAAA,MAAA,OAAAZ,OAAA,CAAAa,MAAA,CAAAD,CAAA,CAAA,CAAA;EAAA,KAAA;EAAA,GAAA,CAAA;EAAA,EAAA,OAAAG,kBAAA,CAAA;EAAA,CAAA,CAX2CI,mBAAa;;;;;;;;;"}